<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../css/style.css" />
    <link rel="stylesheet" type="text/css" href="../css/bootstrap-datetimepicker.css" />
    <link rel="stylesheet" href="../layui/css/layui.css" />
    <script src="../js/jquery-3.1.1.min.js" type="text/javascript"></script>
    <script src="../js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../js/dropdown.js" type="text/javascript"></script>
    <script src="../js/modal.js" type="text/javascript"></script>
    <!--<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=3LSsiAvyTOStAaAc4Nwb2EDyZcUc9lx8"></script>-->
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=NfeFkeBXjyXsHYMsfGPu4V6M4UMkCtFB"></script>
    <script type="text/javascript" src="../layui/layui.js"></script>
    <script src="../lookpic/dist/zoomify.min.js"></script>
    <script type="text/javascript" src="../js/jquery.bootstrap.min.js"></script>
    <title>车报废管理后台</title>
    <script type="text/javascript">
        $('.dropdown-toggle').dropdown()
    </script>
    <style>
        .datetimepicker {
            margin-top: 50px !important;
        }

        .datetimepicker {
            margin-top: 50px !important;
        }

        #allmap {
            width: 100%;
            height: 400px;
        }

        .bigca, .smallca {
            display: none;
        }

        .addpic img {
            width: 133px;
            height: 77px;
        }

        .huixing img, .baofei img {
            width: 133px;
            height: 77px;
        }
    </style>
</head>
<body>
    <div class="back-stage-top">
        <h1 class="pull-left">车报废管理后台</h1>
        <h1 class="pull-right text-primary" id="loginout" style="margin-left:20px;cursor:pointer;font-size:18px;margin-right:50px;" onclick="loginout()">退出</h1>
        <h1 class="pull-right text-primary" id="loginusername" style="margin-left:20px;font-size:18px;">用户名：张三</h1>
    </div>
    <div class="backnav">
        <ul class="backnav">
            <li><a href="index.html">首页</a></li>
            <li><a href="orderlist.html">订单管理</a></li>
            <li class="cur"><a href="scraplist.html">报废汽车</a></li>
            <li><a href="jiulist.html">旧件回收</a></li>
            <li><a href="moneymanage.html">财务管理</a></li>
            <li><a href="system.html">系统设置</a></li>
        </ul>
    </div>
    <div class="tablebox">
        <ol class="breadcrumb m-t-10">
            <li><a href="index.html">首页</a></li>
            <li><a href="orderlist.html">汽车报废</a></li>
            <li>编辑</li>
        </ol>
        <!--车辆信息-->
        <h2 class="text-center" id="orderNo">订单信息：No.000237</h2>
        <div class="col-md-10">
            <table class="table table-bordered">
                <tr>
                    <th width="10%" class="text-right">业务员：</th>
                    <td width="10%"><span id="saleName"></span></td>
                    <th width="10%" class="text-right">委托单位：</th>
                    <td><span id="custormName"></span></td>
                </tr>
                <tr>
                    <th width="120" class="text-right">派单备注：</th>
                    <td colspan="3"><span id="piesNote"></span></td>
                </tr>
            </table>
        </div>
        <div class="col-md-2">
            <h2><span class="label label-primary" id="orderStatus"></span></h2>
        </div>
        <div class="col-md-6">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 车辆信息</h4>
            <input type="hidden" id="clid" />
            <table class="tablelist">
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>车牌号：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="carNumber" /></td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>车架号：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="carFrameNumber" /></td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>车辆型号：</th>
                    <td><input class="form-control" placeholder="" required="" disabled="disabled" autofocus="" type="text" id="carModelNumber" /></td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>能否行驶：</th>
                    <td>
                        <label class="m-r-10">
                            <input type="radio" name="travel" value="1" checked="checked" /> 可以行驶
                        </label>
                        <label class="m-r-10">
                            <input type="radio" name="travel" value="2" /> 不可以行驶
                        </label>
                        <label>
                            <input type="radio" name="travel" value="3" /> 严重事故
                        </label>
                    </td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>车辆归属：</th>
                    <td>
                        <label class="m-r-10">
                            <input type="radio" name="belongto" value="1" checked="checked" /> 个人
                        </label>
                        <label class="m-r-10">
                            <input type="radio" name="belongto" value="2" /> 公户
                        </label>
                    </td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>车主姓名：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="carOwner" /></td>
                </tr>
            </table>
        </div>
        <!--end 车辆信息-->
        <!--取车信息-->
        <div class="col-md-6">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 取车信息</h4>
            <table class="tablelist">
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>取车联系人：</th>
                    <td>
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="" id="takeCarContacts" />
                            <span class="input-group-btn">
                                <button class="btn btn-default quan" type="button" data-toggle="modal" data-target="#contacts">常用联系人</button>
                            </span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>联系人电话：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="takeCarContactNumber" /></td>
                </tr>

                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>取车时间：</th>
                    <td>
                        <div class="input-group">
                            <input type="text" class="form-control" readonly="readonly" aria-label="" id="takeCarTime" />
                            <span role="button" class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>取车地址：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="takeCarAddress" /></td>
                </tr>
            </table>
        </div>
        <!--end 取车信息-->
        <div class="clearfix"></div>
        <!--残值发放信息-->
        <div class="col-md-6">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 残值发放信息</h4>
            <table class="tablelist">
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>收款人姓名：</th>
                    <td>
                        <div class="input-group">
                            <input class="form-control" placeholder="" required="" autofocus="" type="text" id="payeeName" />
                            <span class="input-group-btn">
                                <button class="btn btn-default shoukuanbtn" type="button" data-toggle="modal" data-target="#shoukuan">常用收款账户</button>
                            </span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>银行账户：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="bankAccount" /></td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>开户行：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="openingBank" /></td>
                </tr>
            </table>
        </div>
        <!--end 残值发放信息-->
        <!--手续邮寄信息-->
        <div class="col-md-6">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 手续邮寄信息</h4>
            <table class="tablelist">
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>收件人姓名：</th>
                    <td>
                        <div class="input-group">
                            <input class="form-control" placeholder="" required="" autofocus="" type="text" id="mailingAddressName" />
                            <span class="input-group-btn">
                                <button class="btn btn-default shoujianbtn" type="button" data-toggle="modal" data-target="#shoujian">常用收件人</button>
                            </span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>收件人电话：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="mailingAddressTelephone" /></td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>邮寄地址：</th>
                    <td>
                        <div class="pull-left m-r-10">
                            <select class="form-control" id="provinceselect">
                                <option value="">--请选择--</option>
                            </select>
                        </div>
                        <div class="pull-left m-r-10">
                            <select class="form-control" id="cityselect">
                                <option value="">--请选择--</option>
                            </select>
                        </div>
                        <div class="pull-left">
                            <select class="form-control" id="levelselect">
                                <option value="">--请选择--</option>
                            </select>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th width="120" class="text-right"></th>
                    <td><input class="form-control" placeholder="详细地址" required="" autofocus="" type="text" id="detailedAddress" /></td>
                </tr>
            </table>
        </div>
        <!--end 手续邮寄信息-->
        <!--录入快递信息-->
        <div class="col-md-6">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 录入快递信息</h4>
            <table class="tablelist">
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>快递公司：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="expressCompany" /></td>
                </tr>
                <tr>
                    <th width="120" class="text-right"><span class="redcolor">*</span>快递单号：</th>
                    <td><input class="form-control" placeholder="" required="" autofocus="" type="text" id="expressNumber" /></td>
                </tr>
            </table>
        </div>
        <!--end 录入快递信息-->
        <!--车辆照片-->
        <div class="col-md-12">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 车辆照片</h4>
            <div class="row">
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box  addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(0)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">1</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(0)" />
                        </form>
                    </div>
                    <p class="text-center">左前45度</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(1)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">2</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(1)" />
                        </form>
                    </div>
                    <p class="text-center">正前</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(2)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">3</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(2)" />
                        </form>
                    </div>
                    <p class="text-center">右前45度</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(3)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">4</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(3)" />
                        </form>
                    </div>
                    <p class="text-center">左后45度</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(4)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">5</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(4)" />
                        </form>
                    </div>
                    <p class="text-center">正后</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(5)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">6</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(5)" />
                        </form>
                    </div>
                    <p class="text-center">右后45度</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(6)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">7</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(6)" />
                        </form>
                    </div>
                    <p class="text-center">车架号</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(7)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">8</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(7)" />
                        </form>
                    </div>
                    <p class="text-center">发动机</p>
                </div>
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(8)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">1</span>
                        <span class="smallca">9</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(8)" />
                        </form>
                    </div>
                    <p class="text-center">仪表</p>
                </div>
            </div>
        </div>
        <!--end 车辆照片-->
        <div class="col-md-6">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 手续照片</h4>
            <div class="row">
                <div class="col-xs-4 col-md-4 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(9)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">2</span>
                        <span class="smallca">10</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(9)" />
                        </form>
                    </div>
                    <p class="text-center">行驶证</p>
                </div>
                <div class="col-xs-4 col-md-4 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(10)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">2</span>
                        <span class="smallca">11</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(10)" />
                        </form>
                    </div>
                    <p class="text-center">登记台</p>
                </div>
                <div class="col-xs-4 col-md-4 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(11)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">2</span>
                        <span class="smallca">12</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(11)" />
                        </form>
                    </div>
                    <p class="text-center">车主身份证正前方</p>
                </div>
                <div class="col-xs-4 col-md-4 m-b-20">
                    <div class="thumbnail img-input-box addpic">
                        <img src="../img/addimg-bg.png" alt="" onclick="addactpic(12)" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenpicid" value="" />
                        <span class="bigca">2</span>
                        <span class="smallca">13</span>
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upload2" onchange="doUpload2(12)" />
                        </form>
                    </div>
                    <p class="text-center">车主身份证正后</p>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 车辆毁型照片</h4>
            <div class="row huixing">
                <div class="col-xs-4 col-md-4 m-b-20">
                    <div class="thumbnail img-input-box">
                        <img src="../img/addimg-bg.png" alt="" onclick="addbfactpic('uphxload2')" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenhxpicid" value="" />
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="uphxload2" onchange="dobfhxUpload2('uphxload2')" />
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <h4 class="page-header"><span class="glyphicon glyphicon-list-alt m-l-15"></span> 报废证明照片</h4>
            <div class="row baofei">
                <div class="col-xs-2 col-md-2 m-b-20">
                    <div class="thumbnail img-input-box">
                        <img src="../img/addimg-bg.png" alt="" onclick="addbfactpic('upbfload2')" />
                        <span class="delpic"></span>
                        <input type="hidden" class="hiddenbfpicid" value="" />
                        <form enctype="multipart/form-data" method="post">
                            <input style="display: none;" type="file" multiple="multiple" accept=".png,.jpg,.jpeg,.gif,.PNG,.JPG,.JPEG,.GIF" name="upload" class="upbfload2" onchange="dobfhxUpload2('upbfload2')" />
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="clearfix page-header p-tb30"></div>
        <div class="text-center m-b-20">
            <button class="btn btn-primary btn-lg m-r-10 adddata">保存</button>
        </div>
    </div>
    <!-- 常用联系人 -->
    <div class="hide">
        <div id="detailState">
            <table class="table table-striped addren">
                <thead><tr><th width="200">姓名</th><th>电话</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <!-- 常用收款账户 -->
    <div class="hide">
        <div id="shoukuandetail">
            <table class="table table-striped addshoukuan">
                <thead><tr><th width="200">收款人姓名</th><th>银行账户</th><th>开户行</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <!-- 常用收件人 -->
    <div class="hide">
        <div id="shoujiandetail">
            <table class="table table-striped addshoujian">
                <thead>
                    <tr>
                        <th style="width:90px;">收件人姓名</th>
                        <th style="width:90px;">收件人电话</th>
                        <th style="width:80px;">省份</th>
                        <th style="width:80px;">城市</th>
                        <th style="width:80px;">区域</th>
                        <th style="width:150px;">详细地址</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <!-- 地图 -->
    <div class="hide">
        <input type="hidden" id="coordinate" />
        <div id="showmap" style="z-index:999;">
            <table>
                <tr>
                    <td>
                        <!--<input style="width:400px;" type="text" class="form-control" placeholder="请输入需要检索的地址" name="address" id="address" onkeyup="searchAddress();" value="" />
                        <input type="hidden" id="addressLonglat" name="addressLonglat" value="" />-->


                        <input type="text" id="suggestId" name="Locality" value="" class="form-control"
                               required=required placeholder="请输入车辆所在位置" maxlength="20" style="width:350px;" />
                        <div id="searchResultPanel" style="border:1px solid #C0C0C0;width:150px;height:auto; display:none;z-index:1000;"></div>
                        <div id="l-map" style="width:535px;height:305px;margin-top:10px;margin-left:10px;"></div>


                    </td>
                    <td style="width: 10px;"></td>
                </tr>
            </table>
            <br />
            <div id="allmap"></div>
        </div>
    </div>
    <input type="hidden" id="currentpageid" value="" />
    <script src="../js/modal.js" type="text/javascript"></script>
    <script src="../js/comm.js"></script>
    <script src="../js/bootstrap-datetimepicker.min.js"></script>
    <script src="../js/bootstrap-datetimepicker.zh-CN.js"></script>
    <script>
        layui.use('layer', function () {

        })
        clearnull();
        (function ($) {
            $.getUrlParam = function (name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
                var r = window.location.search.substr(1).match(reg);
                if (r != null) {
                    $("#currentpageid").val(unescape(r[2]));
                    return unescape(r[2]);
                };
                return null;
            }
        })(jQuery);

        var id = $.getUrlParam('id');
        $("#clid").val(id);

        //选择时间
        $('#takeCarTime').datetimepicker({
            format: 'yyyy-mm-dd hh:00:00',
            language: 'zh-CN',
            autoclose: 1,
            minView: "day",
            hoursDisabled: []
        });

        LoadProvinces();
        //查询省份
        function LoadProvinces() {
            $.ajax({
                type: "get",
                url: href + 'dictionary/getAllProvince',
                dataType: "json",
                success: function (obj) {
                    if (obj.msg == "success") {
                        var info = obj.data;
                        var otr = "";
                        var province = $("#provinceselect");
                        for (var i = 0, j = info.length; i < j; i++) {
                            province.append("<option value=" + info[i].id + ">" + info[i].name + "</option>");
                        };
                    }
                }
            })
        }
        $("#provinceselect").change(function () {
            var selectvalue = $("#provinceselect option:selected").val();
            $("#cityselect").empty().append("<option value=''>--请选择--</option>");
            $("#levelselect").empty().append("<option value=''>--请选择--</option>");
            LoadCitys(selectvalue);
        });
        //根据省份查询市区
        function LoadCitys(x, id, lid) {
            var city = $("#cityselect");
            if (x) {
                $("#provinceselect").val(x);
                $.ajax({
                    type: "get",
                    url: href + 'dictionary/getAllCityByProvinceId/' + x,
                    dataType: "json",
                    success: function (obj) {
                        if (obj.msg == "success") {
                            var info = obj.data;
                            var otr = "";
                            for (var i = 0, j = info.length; i < j; i++) {
                                city.append("<option value=" + info[i].id + ">" + info[i].name + "</option>");
                            };
                            if (id) {
                                $("#cityselect").val(id);
                                LoadLevels(id, lid);
                            }
                        }
                    }
                })
            }
            else {
                city.empty();
                city.append("<option value=''>--请选择--</option>");
            }
        }
        $("#cityselect").change(function () {
            $("#levelselect").empty().append("<option value=''>--请选择--</option>");
            var selectvalue = $("#cityselect option:selected").val();
            LoadLevels($("#cityselect option:selected").val());
        });
        //根据市区查询县级地区
        function LoadLevels(x, lid) {
            var level = $("#levelselect");
            if (x) {
                $.ajax({
                    type: "get",
                    url: href + 'dictionary/getAllAreaByCityId/' + x,
                    dataType: "json",
                    success: function (obj) {
                        if (obj.msg == "success") {
                            var info = obj.data;
                            var otr = "";
                            for (var i = 0, j = info.length; i < j; i++) {
                                level.append("<option value=" + info[i].id + ">" + info[i].name + "</option>");
                            };
                            if (lid) {
                                $("#levelselect").val(lid);
                            }
                        }
                    }
                })
            }
            else {
                level.empty();
                level.append("<option value=''>--请选择--</option>");
            }
        }

        LoadPageDetail(id);
        //加载详情
        function LoadPageDetail(id) {
            $.ajax({
                type: "get",
                url: href + 'order/' + id,
                dataType: "json",
                success: function (obj) {
                    if (obj.msg == "success") {
                        var info = obj.data;
                        $("#saleName").html(info.saleName);
                        $("#orderNo").html("订单信息：" + info.orderNo);
                        $("#custormName").html(info.custormName);
                        $("#piesNote").html(info.piesNote);
                        $("#orderStatus").html(GetOrderState(info.orderStatus));
                        $("#carNumber").val(info.carNumber);
                        $("#carFrameNumber").val(info.carFrameNumber);
                        $("#carModelNumber").val(info.carModelNumber);
                        $(":radio[name='travel'][value=" + info.isdrive + "]").prop("checked", "checked");
                        $(":radio[name='belongto'][value='" + info.carAscription + "']").prop("checked", "checked");
                        $("#carOwner").val(info.carOwner);
                        $("#takeCarContacts").val(info.takeCarContacts);
                        $("#takeCarContactNumber").val(info.takeCarContactNumber);
                        $("#takeCarTime").val(info.takeCarTime);
                        $("#takeCarAddress").val(info.takeCarAddress);
                        $("#payeeName").val(info.payeeName);
                        $("#bankAccount").val(info.bankAccount);
                        $("#openingBank").val(info.openingBank);
                        $("#mailingAddressName").val(info.mailingAddressName);
                        $("#mailingAddressTelephone").val(info.mailingAddressTelephone);
                        $("#expressCompany").val(info.expressCompany);
                        $("#expressNumber").val(info.expressNumber);
                        $("#detailedAddress").val(info.detailedAddress);
                        //alert(info.city);
                        $("#provinceselect").val(info.province);
                        $("#cityselect").val(info.city);
                        LoadCitys(info.province, info.city, info.county);
                        //$("#levelselect").val(info.county);

                        //加载车辆照片
                        var pics = info.vehiclePictures;
                        for (i = 0; i < pics.length; i++) {
                            if (pics[i].carPictureType == "1") {
                                $(".addpic").eq(0).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(0).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(0).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "2") {
                                $(".addpic").eq(1).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(1).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(1).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "3") {
                                $(".addpic").eq(2).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(2).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(2).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "4") {
                                $(".addpic").eq(3).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(3).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(3).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "5") {
                                $(".addpic").eq(4).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(4).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(4).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "6") {
                                $(".addpic").eq(5).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(5).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(5).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "7") {
                                $(".addpic").eq(6).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(6).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(6).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "8") {
                                $(".addpic").eq(7).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(7).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(7).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "9") {
                                $(".addpic").eq(8).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(8).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(8).children(".delpic").html(delinfo);
                            }
                        }

                        //加载手续照片
                        pics = info.formalitiesPictures;
                        pic1info = "";
                        for (i = 0; i < pics.length; i++) {
                            if (pics[i].carPictureType == "10") {
                                $(".addpic").eq(9).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(9).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(9).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "11") {
                                $(".addpic").eq(10).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(10).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(10).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "12") {
                                $(".addpic").eq(11).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(11).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(11).children(".delpic").html(delinfo);
                            }
                            if (pics[i].carPictureType == "13") {
                                $(".addpic").eq(12).children("img").attr("src", pics[i].url);
                                $(".addpic").eq(12).children(".hiddenpicid").val(pics[i].id);
                                var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                                $(".addpic").eq(12).children(".delpic").html(delinfo);
                            }
                        }

                        //加载车辆毁型照片
                        pics = info.destroyPictures;
                        pic1info = "";
                        for (i = 0; i < pics.length; i++) {
                            pic1info += '<div class="col-xs-4 col-md-4 m-b-20">';
                            pic1info += '<div class="thumbnail">';
                            pic1info += '<img src="' + pics[i].url + '" alt="" />';
                            pic1info += '<button type="button" class="del-btn" onclick="delhuixing(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                            pic1info += '</div>';
                            pic1info += '</div>';
                        }
                        $(".huixing").append(pic1info);

                        //加载报废证明照片
                        pics = info.certificatePictures;
                        pic1info = "";
                        for (i = 0; i < pics.length; i++) {
                            pic1info += '<div class="col-xs-2 col-md-2 m-b-20">';
                            pic1info += '<div class="thumbnail">';
                            pic1info += '<img src="' + pics[i].url + '" alt="" />';
                            pic1info += '<button type="button" class="del-btn" onclick="delhuixing(this,' + pics[i].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                            pic1info += '</div>';
                            pic1info += '</div>';
                        }
                        $(".baofei").append(pic1info);
                    }
                }
            });
        }

        //根据订单状态返回残值金额状态
        function GetAmountState(a) {
            var result = "";
            if (a == "1" || a == "2" || a == "3" || a == "4" || a == "5") {
                result = "未支付";
            }
            else if (a == "6") {
                result = "部分支付";
            }
            else if (a == "6") {
                result = "已支付";
            }
            else {
                result = "订单异常";
            }
            return result;
        }

        //列表加载订单状态枚举值
        //状态 1:未接单 2：已接单 3:已接收 4：已入场 5：已出库 6：已结算 7结算 8：订单异常
        function GetOrderState(a) {
            var result = "";
            a = a.toString();
            switch (a) {
                case "1": result = "未接单"; break;
                case "2": result = "已接单"; break;
                case "3": result = "已接收"; break;
                case "4": result = "已入场"; break;
                case "5": result = "已出库"; break;
                case "6": result = "已结算"; break;
                case "7": result = "结算"; break;
                default: result = "订单异常";
            }
            return result;
        }

        //常用联系人
        $(document).delegate('.quan', 'click', function (event) {
            event.preventDefault();
            $.ajax({
                type: "get",
                url: href + 'commonContacts?page=1&rows=10',
                dataType: "json",
                success: function (data) {
                    if (data.msg == "success") {
                        var d = data.data.rows;
                        var otr = "";
                        for (var i = 0; i < d.length; i++) {
                            otr += '<tr><td><input type="radio" name="con-per"  class="dancheck" >   ' + d[i].contactName + '</td><td>' + d[i].contactTelephone + '</td></tr>'
                        };
                        $(".addren tbody").html(otr)
                    }
                }
            })
            $('#detailState').dialog({
                title: '常用联系人',
                onClose: function () {
                    $(this).dialog('close');
                },
                buttons: [{
                    text: '取消',
                    'click': function () {
                        $(this).dialog('close');
                    }
                }, {
                    text: '确定',
                    'class': 'btn-primary',
                    'click': function () {
                        for (var i = 0; i < $(".dancheck").length; i++) {
                            if ($(".dancheck").eq(i).prop("checked") == true) {
                                $("#takeCarContacts").val($(".dancheck").eq(i).parent().parent().find("td").eq(0).text());
                                $("#takeCarContactNumber").val($(".dancheck").eq(i).parent().parent().find("td").eq(1).text());
                            }
                        }
                        $('#detailState').dialog('close')
                    }
                }]
            })
        });

        //常用收款账户
        $(document).delegate('.shoukuanbtn', 'click', function (event) {
            event.preventDefault();
            $.ajax({
                type: "get",
                url: href + 'commonPayee?page=1&rows=10&clientid=2193674800c24d899d405b4c64f07412',
                dataType: "json",
                success: function (data) {
                    if (data.msg == "success") {
                        var d = data.data.rows;
                        var otr = "";
                        for (var i = 0; i < d.length; i++) {
                            otr += '<tr><td><input type="radio" name="con-per"  class="shoukuancheck" >' + d[i].payeeName + '</td><td>' + d[i].bankAccount + '</td><td>' + d[i].openingBank + '</td></tr>';
                        };
                        $(".addshoukuan tbody").html(otr)
                    }
                }
            })
            $('#shoukuandetail').dialog({
                title: '常用收款账户',
                onClose: function () {
                    $(this).dialog('close');
                },
                buttons: [{
                    text: '取消',
                    'click': function () {
                        $(this).dialog('close');
                    }
                }, {
                    text: '确定',
                    'class': 'btn-primary',
                    'click': function () {
                        for (var i = 0; i < $(".shoukuancheck").length; i++) {
                            if ($(".shoukuancheck").eq(i).prop("checked") == true) {
                                $("#payeeName").val($(".shoukuancheck").eq(i).parent().parent().find("td").eq(0).text());
                                $("#bankAccount").val($(".shoukuancheck").eq(i).parent().parent().find("td").eq(1).text());
                                $("#openingBank").val($(".shoukuancheck").eq(i).parent().parent().find("td").eq(2).text());
                            }
                        }
                        $('#shoukuandetail').dialog('close')
                    }
                }]
            })
        });

        //常用收件人
        $(document).delegate('.shoujianbtn', 'click', function (event) {
            event.preventDefault();
            $.ajax({
                type: "get",
                //url: href + 'commonMailing?page=1&rows=10&clientid=1453674800c24d899d405b4c64f07412',
                //url: "http://60.205.223.142/carscraporder-manager/external/commonMailing?page=1&rows=10",
                url: href +"commonMailing?page=1&rows=10&clientid=1453674800c24d899d405b4c64f07412",
                dataType: "json",
                success: function (data) {
                    if (data.msg == "success") {
                        var d = data.data.rows;
                        var otr = "";
                        for (var i = 0; i < d.length; i++) {
                            otr += '<tr>';
                            otr += '<td><input type="radio" name="con-per"  class="shoujiancheck" >' + d[i].mailingAddressName + '</td>';
                            otr += '<td> ' + d[i].mailingAddressTelephone + '</td >';
                            otr += '<td>' + LoadProvince(d[i].province) + '<input type="hidden" value=' + d[i].province + ' /></td>';
                            otr += '<td>' + LoadCity(d[i].city) + '<input type="hidden" value=' + d[i].city + ' /></td>';
                            otr += '<td>' + LoadArea(d[i].county) + '<input type="hidden" value=' + d[i].county + ' /></td>';
                            otr += '<td>' + d[i].detailedAddress + '</td>';
                            otr += '</tr > ';
                        }
                        $(".addshoujian tbody").html(otr)
                    }
                }
            })
            $('#shoujiandetail').dialog({
                title: '常用收件人',
                onClose: function () {
                    $(this).dialog('close');
                },
                buttons: [{
                    text: '取消',
                    'click': function () {
                        $(this).dialog('close');
                    }
                }, {
                    text: '确定',
                    'class': 'btn-primary',
                    'click': function () {
                        for (var i = 0; i < $(".shoujiancheck").length; i++) {
                            if ($(".shoujiancheck").eq(i).prop("checked") == true) {
                                $("#mailingAddressName").val($(".shoujiancheck").eq(i).parent().parent().find("td").eq(0).text());
                                $("#mailingAddressTelephone").val($(".shoujiancheck").eq(i).parent().parent().find("td").eq(1).text());
                                var sheng = $(".shoujiancheck").eq(i).parent().parent().find("td").eq(2).find("input").val();
                                var shi = $(".shoujiancheck").eq(i).parent().parent().find("td").eq(3).find("input").val();
                                var qu = $(".shoujiancheck").eq(i).parent().parent().find("td").eq(4).find("input").val();
                                $("#detailedAddress").val($(".shoujiancheck").eq(i).parent().parent().find("td").eq(5).text());
                                //加载省市区
                                LoadCitys(sheng, shi, qu);
                            }
                        }
                        $('#shoujiandetail').dialog('close')
                    }
                }]
            })
        });

        //加载省份
        function LoadProvince(a) {
            var result = "";
            if (a) {
                $.ajax({
                    type: "get",
                    url: href + "provinces/" + a,
                    async: false,
                    dataType: "json",
                    success: function (obj) {
                        if (obj.msg == "success") {
                            if (obj.data) {
                                result += obj.data.province;
                            }
                        }
                    }
                });
            }
            return result;
        }
        //加载城市
        function LoadCity(b) {
            var result = "";
            if (b) {
                $.ajax({
                    type: "get",
                    url: href +"cityes/" + b,
                    dataType: "json",
                    async: false,
                    success: function (obj) {
                        if (obj.msg == "success") {
                            if (obj.data) {
                                result += obj.data.city;
                            }
                        }
                    }
                });
            }
            return result;
        }
        //加载区域
        function LoadArea(c) {
            var result = "";
            if (c) {
                $.ajax({
                    type: "get",
                    url: href +"areas/" + c,
                    dataType: "json",
                    async: false,
                    success: function (obj) {
                        if (obj.msg == "success") {
                            if (obj.data) {
                                result += obj.data.area;
                            }
                        }
                    }
                });
            }
            return result;
        }

        //报废图片上传
        function addbfactpic(a) {
            $('.' + a).get(0).click();
        };
        function dobfhxUpload2(a) {
            var formData = new FormData();
            if ($('.' + a)[0].files.length == 0) {
                alert("请选择pc母版！");
                return false;
            };
            var pics = $('.' + a)[0].files[0].name;
            if (!/\.(jpg|png|gif|jpeg|JPG|PNG|GIF|JPEG)$/.test(pics)) {
                alert("请上传正确图片格式");
                $('.' + a).val("");
                return;
            };
            var sizes = $('.' + a)[0].files[0].size;
            var pan = Math.round(sizes / 1024 * 100) / 100;
            if (pan > 4096) {
                alert("所传图片不能大于4M");
                //$(".upload2").val("");
                return;
            };
            formData.append("files", $('.' + a)[0].files[0]);
            var cid = $("#clid").val();
            var businessType = "1";
            var pictureType = "3";
            if (a == "upbfload2") {
                pictureType = "4";
            }
            $.ajax({
                url: "http://60.205.223.142/carscraporder-attachment/upload/carattachment/" + cid + "?businessType=" + businessType + "&pictureType=" + pictureType,
                type: "POST",
                data: formData,
                dataType: "json",
                async: false,
                cache: false,
                contentType: false,
                processData: false,
                success: function (obj) {
                    console.log(obj);
                    var otr = ""
                    if (obj.msg == "success") {
                        if (obj.data.length) {
                            pic1info = "";
                            if (a == "uphxload2") {
                                pic1info += '<div class="col-xs-2 col-md-4 m-b-20">';
                            }
                            else {
                                pic1info += '<div class="col-xs-2 col-md-2 m-b-20">';
                            }
                            pic1info += '<div class="thumbnail">';
                            pic1info += '<img src="' + obj.data[0].url + '" alt="" />';
                            if (a == "uphxload2") {
                                pic1info += '<input type="hidden" class="hiddenhxpicid" value="' + obj.data[0].id + '" />';
                            }
                            else {
                                pic1info += '<input type="hidden" class="hiddenbfpicid" value="' + obj.data[0].id + '" />';
                            }
                            pic1info += '<button type="button" class="del-btn" onclick="delhuixing(this,' + obj.data[0].id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                            pic1info += '</div>';
                            pic1info += '</div>';
                            if (a == "uphxload2") {
                                $(".huixing").append(pic1info);
                            }
                            else {
                                $(".baofei").append(pic1info);
                            }
                        }
                    };
                },
                error: function (returndata) {
                    alert("操作失败");
                }
            });
        };
        //删除图片
        function delhuixing(x, picid) {
            $.ajax({
                url: "http://60.205.223.142/carscraporder-manager/carattachment/" + picid,
                type: "DELETE",
                dataType: "json",
                async: false,
                success: function (obj) {
                    if (obj.msg == "success") {
                        if (obj.data) {
                            console.log("删除图片id=" + picid);
                            $(x).parent().parent().remove();
                        }
                    }
                }
            });
        }
        //删除图片
        function del(x, picid) {
            $.ajax({
                url: "http://60.205.223.142/carscraporder-manager/carattachment/" + picid,
                type: "DELETE",
                dataType: "json",
                async: false,
                success: function (obj) {
                    if (obj.msg == "success") {
                        $(x).parent().parent().children("img").attr("src", "../img/addimg-bg.png");
                        $(x).parent().parent().children("input[type='hidden']").val("");
                        $(x).parent().html("");
                    }
                }
            });
        }


        //上传图片
        function addactpic(a) {
            $(".upload2").get(a).click();
        };
        //删除图片
        function del(x, picid) {
            $.ajax({
                url: "http://60.205.223.142/carscraporder-manager/carattachment/" + picid,
                type: "DELETE",
                dataType: "json",
                async: false,
                success: function (obj) {
                    if (obj.msg == "success") {
                        $(x).parent().parent().children("img").attr("src", "../img/addimg-bg.png");
                        $(x).parent().parent().children("input[type='hidden']").val("");
                        $(x).parent().html("");
                    }
                }
            });
        }
        function doUpload2(a) {
            var formData = new FormData();
            if ($(".upload2")[a].files.length == 0) {
                alert("请选择pc母版！");
                return false;
            };
            var pics = $(".upload2")[a].files[0].name;
            if (!/\.(jpg|png|gif|jpeg|JPG|PNG|GIF|JPEG)$/.test(pics)) {
                alert("请上传正确图片格式");
                $(".upload2").val("");
                return;
            };
            var sizes = $(".upload2")[a].files[0].size;
            var pan = Math.round(sizes / 1024 * 100) / 100;
            if (pan > 4096) {
                alert("所传图片不能大于4M");
                //$(".upload2").val("");
                return;
            };
            var picszhui = pics.split('.')[1];
            var picsqian = $(".addpic").eq(a).parent().children("p").html();
            var newfile = $(".upload2")[a].files[0];
            var newname = picsqian + "." + picszhui;
            var dfl = new File([newfile], newname, { type: newfile.type });
            formData.append("files", dfl);
            //formData.append("files", $(".upload2")[a].files[0]);
            var cid = $("#clid").val();
            var pictureType = $(".addpic").eq(a).children(".bigca").text();
            var picturePecialType = $(".addpic").eq(a).children(".smallca").text();
            $.ajax({
                url: "http://60.205.223.142/carscraporder-attachment/upload/carattachment/" + cid + "?businessType=1&pictureType=" + pictureType + "&picturePecialType=" + picturePecialType,
                type: "POST",
                data: formData,
                dataType: "json",
                async: false,
                cache: false,
                contentType: false,
                processData: false,
                success: function (obj) {
                    if (obj.msg == "success") {
                        if (obj.data.length) {
                            $(".addpic").eq(a).children("img").attr("src", obj.data[0].url);
                            var id = obj.data[0].id;
                            $(".addpic").eq(a).children("input[type='hidden']").val(id);
                            var delinfo = '<button type="button" class="del-btn" onclick="del(this,' + id + ')"><span class="glyphicon glyphicon-remove"></span></button>';
                            $(".addpic").eq(a).children(".delpic").html(delinfo);
                        }
                    };
                },
                error: function (returndata) {
                    alert("操作失败");
                }
            });
        };

        // 百度地图API功能
        function G(id) {
            return document.getElementById(id);
        }

        var map = new BMap.Map("l-map");
        map.setCurrentCity("北京");
        map.enableScrollWheelZoom();//启动鼠标滚轮缩放地图
        map.centerAndZoom(new BMap.Point(116.4136103013, 39.9110666857), 12);                // 初始化地图,设置城市和地图级别。
        map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
        //单击获取点击的经纬度
        //map.addEventListener("click", function (e) {
        //    alert(e.point.lng + "," + e.point.lat);
        //});
        var geoc = new BMap.Geocoder();
        var ac = new BMap.Autocomplete(    //建立一个自动完成的对象
            {
                "input": "suggestId"
                , "location": map
            });
        map.addEventListener("click", function (e) {
            var pt = e.point;
            console.log(pt);
            $("#coordinate").val(pt.lng + "," + pt.lat);
            geoc.getLocation(pt, function (rs) {
                map.clearOverlays();
                map.addOverlay(new BMap.Marker(pt));
                var addComp = rs.addressComponents;
                $("#suggestId").val(addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber);

            });
        });
        console.log("ss");
        ac.addEventListener("onhighlight", function (e) {  //鼠标放在下拉列表上的事件
            var str = "";
            var _value = e.fromitem.value;
            var value = "";
            if (e.fromitem.index > -1) {
                value = _value.province + _value.city + _value.district + _value.street + _value.business;
            }
            str = "FromItem<br />index = " + e.fromitem.index + "<br />value = " + value;

            value = "";
            if (e.toitem.index > -1) {
                _value = e.toitem.value;
                value = _value.province + _value.city + _value.district + _value.street + _value.business;
            }
            str += "<br />ToItem<br />index = " + e.toitem.index + "<br />value = " + value;
            G("searchResultPanel").innerHTML = str;
        });

        var myValue;
        ac.addEventListener("onconfirm", function (e) {    //鼠标点击下拉列表后的事件
            var _value = e.item.value;
            myValue = _value.province + _value.city + _value.district + _value.street + _value.business;
            G("searchResultPanel").innerHTML = "onconfirm<br />index = " + e.item.index + "<br />myValue = " + myValue;
            setPlace();
        });

        function setPlace() {
            map.clearOverlays();    //清除地图上所有覆盖物
            function myFun() {
                var pp = local.getResults().getPoi(0).point;    //获取第一个智能搜索的结果
                map.centerAndZoom(pp, 18);
                map.addOverlay(new BMap.Marker(pp));    //添加标注
            }
            var local = new BMap.LocalSearch(map, { //智能搜索
                onSearchComplete: myFun
            });
            local.search(myValue);
        }
        //点击打开地图
        $(document).delegate('#takeCarAddress', 'click', function (event) {
            event.preventDefault();
            $('#showmap').dialog({
                title: '取车地址',
                onClose: function () {
                    $(this).dialog('close');
                },
                buttons: [{
                    text: '取消',
                    'click': function () {
                        $(this).dialog('close');
                    }
                }, {
                    text: '确定',
                    'class': 'btn-primary',
                    'click': function () {

                        $(".setmap").val($("#suggestId").val());
                        $('#showmap').dialog('close');
                    }
                }]
            })
            map.centerAndZoom("北京", 11);      // 用城市名设置地图中心点
        });

        //数据提交
        $(".adddata").on("click", function (event) {
            if ($("#carNumber").val() == "") {
                layer.msg('<span style="font-size:20px">车牌号不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#carFrameNumber").val() == "") {
                layer.msg('<span style="font-size:20px">车架号不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#carModelNumber").val() == "") {
                layer.msg('<span style="font-size:20px">车辆型号不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            var travel = $(":radio[name=travel]:checked").val();
            if (travel == "") {
                layer.msg('<span style="font-size:20px">请选择能否驾驶</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            var belongto = $(":radio[name=belongto]:checked").val();
            if (belongto == "") {
                layer.msg('<span style="font-size:20px">请选择车辆归属</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#carOwner").val() == "") {
                layer.msg('<span style="font-size:20px">车主姓名不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            var picArray = [];
            var shouxuArray = [];
            var picLength = $(".addpic").length;
            if (picLength == 0) {
                //layer.msg('<span style="font-size:20px">请上传车辆与手续照片</span>', {
                //    time: 2000, //2s后自动关闭
                //});
                //return;
            }
            else {
                for (var t = 0; t < picLength; t++) {
                    var id = $(".addpic").eq(t).find(".hiddenpicid").val();
                    if (id) {
                        var bigca = $(".addpic").eq(t).find(".bigca").text();
                        var smallca = $(".addpic").eq(t).find(".smallca").text();
                        if (t > 8) {
                            shouxuArray.push({
                                pritureCategory: parseInt(bigca),
                                pritureType: parseInt(smallca),
                                attachmentId: id
                            });
                        }
                        else {
                            picArray.push({
                                pritureCategory: parseInt(bigca),
                                pritureType: parseInt(smallca),
                                attachmentId: id
                            });
                        }
                    }
                }
            }
            console.log(shouxuArray);
            console.log(picArray);
            if ($("#payeeName").val() == "") {
                layer.msg('<span style="font-size:20px">收款人姓名不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#bankAccount").val() == "") {
                layer.msg('<span style="font-size:20px">银行账户不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#openingBank").val() == "") {
                layer.msg('<span style="font-size:20px">开户行不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#takeCarContacts").val() == "") {
                layer.msg('<span style="font-size:20px">取车联系人不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#takeCarContactNumber").val() == "") {
                layer.msg('<span style="font-size:20px">取车联系人电话不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#takeCarTime").val() == "") {
                layer.msg('<span style="font-size:20px">取件时间不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            var qccity = $("#takeCarAddress").val();
            if (qccity == "") {
                layer.msg('<span style="font-size:20px">取件地址不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            }
            if ($("#mailingAddressName").val() == "") {
                layer.msg('<span style="font-size:20px">收件人姓名不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#mailingAddressTelephone").val() == "") {
                layer.msg('<span style="font-size:20px">收件人电话不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#provinceselect option:selected").val() == "") {
                layer.msg('<span style="font-size:20px">邮寄地址省份不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#cityselect option:selected").val() == "") {
                layer.msg('<span style="font-size:20px">邮寄地址市区不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#levelselect option:selected").val() == "") {
                layer.msg('<span style="font-size:20px">邮寄地址县级市不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            if ($("#detailedAddress").val() == "") {
                layer.msg('<span style="font-size:20px">邮寄详细地址不能为空</span>', {
                    time: 2000, //2s后自动关闭
                });
                return;
            };
            //毁型照片
            var hxpicArray = [];
            var hxpicLength = $(".huixing").find("img").length;
            if (hxpicLength > 1) {
                for (var t = 1; t <= hxpicLength; t++) {
                    var id = $(".huixing").find(".hiddenhxpicid").eq(t).val();
                    var url = $(".huixing").find("img").eq(t).attr("src");
                    if (id) {
                        hxpicArray.push({
                            url: url,
                            id: id
                        });
                    }
                }
            }
            console.log(hxpicArray);
            //报废照片
            var bfpicArray = [];
            var bfpicLength = $(".baofei").find("img").length;
            if (bfpicLength > 1) {
                for (var t = 1; t <= bfpicLength; t++) {
                    var id = $(".baofei").find(".hiddenbfpicid").eq(t).val();
                    var url = $(".baofei").find("img").eq(t).attr("src");
                    if (id) {
                        bfpicArray.push({
                            url: url,
                            id: id
                        });
                    }
                }
            }
            $.ajax({
                type: "PUT",
                url: href + "order/" + $("#currentpageid").val(),
                data: {
                    carNumber: $("#carNumber").val(),
                    carFrameNumber: $("#carFrameNumber").val(),
                    carModelNumber: $("#carModelNumber").val(),
                    isdrive: travel,
                    carAscription: belongto,
                    carOwner: $("#carOwner").val(),
                    orderType: 1,//订单类型 1：整车 2：旧件 这里固定传递 1
                    takeCarContacts: $("#takeCarContacts").val(),
                    takeCarContactNumber: $("#takeCarContactNumber").val(),
                    takeCarTime: $("#takeCarTime").val(),
                    orderAreasId: $("#firstcityid").val(),
                    takeCarAddress: $("#takeCarAddress").val(),
                    coordinate: $("#coordinate").val(),
                    payeeName: $("#payeeName").val(),
                    bankAccount: $("#bankAccount").val(),
                    openingBank: $("#openingBank").val(),
                    mailingAddressName: $("#mailingAddressName").val(),
                    mailingAddressTelephone: $("#mailingAddressTelephone").val(),
                    province: $("#provinceselect option:selected").val(),
                    city: $("#cityselect option:selected").val(),
                    county: $("#levelselect option:selected").val(),
                    detailedAddress: $("#detailedAddress").val(),
                    expressCompany: $("#expressCompany").val(),
                    expressNumber: $("#expressNumber").val(),
                    //vehiclePictures: picArray,
                    //formalitiesPictures: shouxuArray,
                    //destroyPictures: hxpicArray,
                    //certificatePictures: bfpicArray
                },
                dataType: "json",
                success: function (data) {
                    console.log(data);
                    if (data.msg == "success") {
                        if (data.data) {
                            layer.msg('<span style="font-size:20px">报废提交成功</span>', {
                                time: 1000, //2s后自动关闭
                            }, function () {
                                window.location.href = "scraplist.html"
                            });
                        }
                    }
                }
            });
        });

        //根据车架号查询车型名称
        $("#carFrameNumber").on("blur", function () {
            if ($("#carFrameNumber").val()) {
                var index = layer.msg('<span style="font-size:20px">数据加载中</span>', {
                });
                $.ajax({
                    type: "get",
                    url: href + "carModel?vin=" + $(".carjia").val(),
                    dataType: "json",
                    success: function (data) {
                        if (data.msg == "success") {
                            layer.close(index);
                            if (data.data == "") {
                                $("#carModelNumber").val("");
                                $("#carModelNumber").attr("placeholder", '车辆型号无法识别，请自行填写')
                                $("#carModelNumber").attr("disabled", false)
                            } else {
                                $("#carModelNumber").attr("disabled", "disabled");
                                $("#carModelNumber").val(data.data)
                            }
                        }
                    }
                });
            }
            else {
                $("#carModelNumber").attr("disabled", "disabled");
                $("#carModelNumber").val("");
                $("#carModelNumber").attr("placeholder", '');
            }
        });
    </script>
</body>
</html>
